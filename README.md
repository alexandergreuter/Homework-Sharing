This is old code and probably has a few issues, avoid forking it.
